(function(){"use strict";function a(a,b,c,d,e,f){return{tag:a,key:b,attrs:c,children:d,text:e,dom:f,domSize:void 0,state:void 0,events:void 0,instance:void 0}}function b(a){for(var b in a)if(i.call(a,b))return!1;return!0}function c(a){for(var b,c="div",d=[],e={};b=g.exec(a);){var f=b[1],i=b[2];if(""===f&&""!==i)c=i;else if("#"===f)e.id=i;else if("."===f)d.push(i);else if("["===b[3][0]){var j=b[6];j&&(j=j.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===b[4]?d.push(j):e[b[4]]=""===j?j:j||!0}}return 0<d.length&&(e.className=d.join(" ")),h[a]={tag:c,attrs:e}}function d(c,d){var e=d.attrs,f=a.normalizeChildren(d.children),g=i.call(e,"class"),h=g?e.class:e.className;if(d.tag=c.tag,d.attrs=null,d.children=void 0,!b(c.attrs)&&!b(e)){var j={};for(var k in e)i.call(e,k)&&(j[k]=e[k]);e=j}for(var k in c.attrs)i.call(c.attrs,k)&&"className"!==k&&!i.call(e,k)&&(e[k]=c.attrs[k]);for(var k in(null!=h||null!=c.attrs.className)&&(e.className=null==h?null==c.attrs.className?null:c.attrs.className:null==c.attrs.className?h:c.attrs.className+" "+(h+"")),g&&(e.class=null),e)if(i.call(e,k)&&"key"!==k){d.attrs=e;break}return Array.isArray(f)&&1===f.length&&null!=f[0]&&"#"===f[0].tag?d.text=f[0].children:d.children=f,d}function e(b){if(null==b||"string"!=typeof b&&"function"!=typeof b&&"function"!=typeof b.view)throw Error("The selector must be either a string or a component.");var e=f.apply(1,arguments);if("string"!=typeof b)b.defaultAttrs&&(e.attrs={...b.defaultAttrs,...e.attrs});else if(e.children=a.normalizeChildren(e.children),"["!==b)return d(h[b]||c(b),e);return e.tag=b,e}a.normalize=function(b){return Array.isArray(b)?a("[",void 0,void 0,a.normalizeChildren(b),void 0,void 0):null==b||"boolean"==typeof b?null:"object"==typeof b?b:a("#",void 0,void 0,b+"",void 0,void 0)},a.normalizeChildren=function(b){var c=[];if(b.length){for(var d=null!=b[0]&&null!=b[0].key,e=1;e<b.length;e++)if((null!=b[e]&&null!=b[e].key)!==d)throw new TypeError("Vnodes must either always have keys or never have keys!");for(var e=0;e<b.length;e++)c[e]=a.normalize(b[e])}return c};var f=function(){var b,c=arguments[this],d=this+1;if(null==c?c={}:("object"!=typeof c||null!=c.tag||Array.isArray(c))&&(c={},d=this),arguments.length===d+1)b=arguments[d],Array.isArray(b)||(b=[b]);else for(b=[];d<arguments.length;)b.push(arguments[d++]);return a("",c.key,c,b)},g=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,h={},i={}.hasOwnProperty;e.trust=function(b){return null==b&&(b=""),a("<",void 0,void 0,b,void 0,void 0)},e.fragment=function(){var b=f.apply(0,arguments);return b.tag="[",b.children=a.normalizeChildren(b.children),b};var j=function(b){function c(a){return a.attrs&&a.attrs.xmlns||Z[a.tag]}function d(a,b){if(a.state!==b)throw new Error("`vnode.state` must not be modified")}function e(a){var b=a.state;try{return this.apply(b,arguments)}finally{d(a,b)}}function f(){try{return Y.activeElement}catch(a){return null}}function g(a,b,c,d,e,f,g){for(var j,k=c;k<d;k++)j=b[k],null!=j&&h(a,j,e,g,f)}function h(a,b,c,d,e){var f=b.tag;"string"==typeof f?(b.state={},null!=b.attrs&&U(b.attrs,b,c),"#"===f?i(a,b,e):"<"===f?j(a,b,d,e):"["===f?k(a,b,c,d,e):l(a,b,c,d,e)):n(a,b,c,d,e)}function i(a,b,c){b.dom=Y.createTextNode(b.children),A(a,b.dom,c)}function j(a,b,c,d){var e=b.children.match(/^\s*?<(\w+)/im)||[],f=Y.createElement($[e[1]]||"div");"http://www.w3.org/2000/svg"===c?(f.innerHTML="<svg xmlns=\"http://www.w3.org/2000/svg\">"+b.children+"</svg>",f=f.firstChild):f.innerHTML=b.children,b.dom=f.firstChild,b.domSize=f.childNodes.length,b.instance=[];for(var g,h=Y.createDocumentFragment();g=f.firstChild;)b.instance.push(g),h.appendChild(g);A(a,h,d)}function k(a,b,c,d,e){var f=Y.createDocumentFragment();if(null!=b.children){var h=b.children;g(f,h,0,h.length,c,null,d)}b.dom=f.firstChild,b.domSize=f.childNodes.length,A(a,f,e)}function l(b,d,e,f,h){var i=d.tag,j=d.attrs,k=j&&j.is;f=c(d)||f;var l=f?k?Y.createElementNS(f,i,{is:k}):Y.createElementNS(f,i):k?Y.createElement(i,{is:k}):Y.createElement(i);if(d.dom=l,null!=j&&H(d,j,f),A(b,l,h),!B(d)&&(null!=d.text&&(""===d.text?d.children=[a("#",void 0,void 0,d.text,void 0,void 0)]:l.textContent=d.text),null!=d.children)){var m=d.children;g(l,m,0,m.length,e,null,f),"select"===d.tag&&null!=j&&K(d,j)}}function m(b,c){var d;if("function"==typeof b.tag.view){if(b.state=Object.create(b.tag),d=b.state.view,null!=d.$$reentrantLock$$)return;d.$$reentrantLock$$=!0}else{if(b.state=void 0,d=b.tag,null!=d.$$reentrantLock$$)return;d.$$reentrantLock$$=!0,b.state=null!=b.tag.prototype&&"function"==typeof b.tag.prototype.view?new b.tag(b):b.tag(b)}if(U(b.state,b,c),null!=b.attrs&&U(b.attrs,b,c),b.instance=a.normalize(e.call(b.state.view,b)),b.instance===b)throw Error("A view cannot return the vnode it received as argument");d.$$reentrantLock$$=null}function n(a,b,c,d,e){m(b,c),null==b.instance?b.domSize=0:(h(a,b.instance,c,d,e),b.dom=b.instance.dom,b.domSize=null==b.dom?0:b.instance.domSize)}function o(a,b,c,d,e,f){if(b!==c&&(null!=b||null!=c))if(null==b||0===b.length)g(a,c,0,c.length,d,e,f);else if(null==c||0===c.length)C(a,b,0,b.length);else{var j=null!=b[0]&&null!=b[0].key,k=null!=c[0]&&null!=c[0].key,l=0,m=0;if(!j)for(;m<b.length&&null==b[m];)m++;if(!k)for(;l<c.length&&null==c[l];)l++;if(null===k&&null==j)return;if(j!==k)C(a,b,m,b.length),g(a,c,l,c.length,d,e,f);else if(!k){var n=b.length<c.length?b.length:c.length;for(l=l<m?l:m;l<n;l++)if(r=b[l],s=c[l],r===s||null==r&&null==s)continue;else null==r?h(a,s,d,f,x(b,l+1,e)):null==s?D(a,r):p(a,r,s,d,x(b,l+1,e),f);b.length>n&&C(a,b,l,b.length),c.length>n&&g(a,c,l,c.length,d,e,f)}else{for(var q,r,s,t,u,z,A=b.length-1,B=c.length-1;A>=m&&B>=l&&(t=b[A],u=c[B],t.key===u.key);)t!==u&&p(a,t,u,d,e,f),null!=u.dom&&(e=u.dom),A--,B--;for(;A>=m&&B>=l&&(r=b[m],s=c[l],r.key===s.key);)m++,l++,r!==s&&p(a,r,s,d,x(b,m,e),f);for(;A>=m&&B>=l&&l!==B&&r.key===u.key&&t.key===s.key;)z=x(b,m,e),y(a,t,z),t!==s&&p(a,t,s,d,z,f),++l<=--B&&y(a,r,e),r!==u&&p(a,r,u,d,e,f),null!=u.dom&&(e=u.dom),m++,A--,t=b[A],u=c[B],r=b[m],s=c[l];for(;A>=m&&B>=l&&t.key===u.key;)t!==u&&p(a,t,u,d,e,f),null!=u.dom&&(e=u.dom),A--,B--,t=b[A],u=c[B];if(l>B)C(a,b,m,A+1);else if(m>A)g(a,c,l,B+1,d,e,f);else{var q,E,F=e,G=B-l+1,H=Array(G),I=0,J=0,K=2147483647,L=0;for(J=0;J<G;J++)H[J]=-1;for(J=B;J>=l;J--){null==q&&(q=v(b,m,A+1)),u=c[J];var M=q[u.key];null!=M&&(K=M<K?M:-1,H[J-l]=M,t=b[M],b[M]=null,t!==u&&p(a,t,u,d,e,f),null!=u.dom&&(e=u.dom),L++)}if(e=F,L!=A-m+1&&C(a,b,m,A+1),0==L)g(a,c,l,B+1,d,e,f);else if(-1===K)for(E=w(H),I=E.length-1,J=B;J>=l;J--)s=c[J],-1===H[J-l]?h(a,s,d,f,e):E[I]===J-l?I--:y(a,s,e),null!=s.dom&&(e=c[J].dom);else for(J=B;J>=l;J--)s=c[J],-1===H[J-l]&&h(a,s,d,f,e),null!=s.dom&&(e=c[J].dom)}}}}function p(a,b,c,d,e,f){var g=b.tag,i=c.tag;if(g===i){if(c.state=b.state,c.events=b.events,W(c,b))return;"string"==typeof g?(null!=c.attrs&&V(c.attrs,c,d),"#"===g?q(b,c):"<"===g?r(a,b,c,f,e):"["===g?s(a,b,c,d,e,f):t(b,c,d,f)):u(a,b,c,d,e,f)}else D(a,b),h(a,c,d,f,e)}function q(a,b){a.children.toString()!==b.children.toString()&&(a.dom.nodeValue=b.children),b.dom=a.dom}function r(a,b,c,d,e){b.children===c.children?(c.dom=b.dom,c.domSize=b.domSize,c.instance=b.instance):(E(a,b),j(a,c,d,e))}function s(a,b,c,d,e,f){o(a,b.children,c.children,d,e,f);var g=0,h=c.children;if(c.dom=null,null!=h){for(var j,k=0;k<h.length;k++)j=h[k],null!=j&&null!=j.dom&&(null==c.dom&&(c.dom=j.dom),g+=j.domSize||1);1!==g&&(c.domSize=g)}}function t(b,d,e,f){var g=d.dom=b.dom;f=c(d)||f,"textarea"===d.tag&&(null==d.attrs&&(d.attrs={}),null!=d.text&&(d.attrs.value=d.text,d.text=void 0)),L(d,b.attrs,d.attrs,f),B(d)||(null!=b.text&&null!=d.text&&""!==d.text?b.text.toString()!==d.text.toString()&&(b.dom.firstChild.nodeValue=d.text):(null!=b.text&&(b.children=[a("#",void 0,void 0,b.text,void 0,b.dom.firstChild)]),null!=d.text&&(d.children=[a("#",void 0,void 0,d.text,void 0,void 0)]),o(g,b.children,d.children,e,null,f)))}function u(b,c,d,f,g,i){if(d.instance=a.normalize(e.call(d.state.view,d)),d.instance===d)throw Error("A view cannot return the vnode it received as argument");V(d.state,d,f),null!=d.attrs&&V(d.attrs,d,f),null==d.instance?null==c.instance?(d.dom=c.dom,d.domSize=c.domSize):(D(b,c.instance),d.dom=void 0,d.domSize=0):(null==c.instance?h(b,d.instance,f,i,g):p(b,c.instance,d.instance,f,g,i),d.dom=d.instance.dom,d.domSize=d.instance.domSize)}function v(a,b,c){for(var d,e=Object.create(null);b<c;b++)if(d=a[b],null!=d){var f=d.key;null!=f&&(e[f]=b)}return e}function w(b){for(var a=[0],d=0,e=0,f=0,g=_.length=b.length,f=0;f<g;f++)_[f]=b[f];for(var f=0;f<g;++f)if(-1!==b[f]){var h=a[a.length-1];if(b[h]<b[f]){_[f]=h,a.push(f);continue}for(d=0,e=a.length-1;d<e;){var j=(d>>>1)+(e>>>1)+(1&(d&e));b[a[j]]<b[f]?d=j+1:e=j}b[f]<b[a[d]]&&(0<d&&(_[f]=a[d-1]),a[d]=f)}for(d=a.length,e=a[d-1];0<d--;)a[d]=e,e=_[e];return _.length=0,a}function x(a,b,c){for(;b<a.length;b++)if(null!=a[b]&&null!=a[b].dom)return a[b].dom;return c}function y(a,b,c){var d=Y.createDocumentFragment();z(a,d,b),A(a,d,c)}function z(a,b,c){for(;null!=c.dom&&c.dom.parentNode===a;){if("string"!=typeof c.tag){if(c=c.instance,null!=c)continue;}else if("<"===c.tag)for(var d=0;d<c.instance.length;d++)b.appendChild(c.instance[d]);else if("["!==c.tag)b.appendChild(c.dom);else if(1!==c.children.length)for(var e,d=0;d<c.children.length;d++)e=c.children[d],null!=e&&z(a,b,e);else if(c=c.children[0],null!=c)continue;break}}function A(a,b,c){null==c?a.appendChild(b):a.insertBefore(b,c)}function B(a){if(null==a.attrs||null==a.attrs.contenteditable&&null==a.attrs.contentEditable)return!1;var b=a.children;if(null!=b&&1===b.length&&"<"===b[0].tag){var c=b[0].children;a.dom.innerHTML!==c&&(a.dom.innerHTML=c)}else if(null!=a.text||null!=b&&0!==b.length)throw new Error("Child node of a contenteditable must be trusted");return!0}function C(a,b,c,d){for(var e,f=c;f<d;f++)e=b[f],null!=e&&D(a,e)}function D(a,b){function c(){d(b,i),G(b),F(a,b)}var f,g,h=0,i=b.state;if("string"!=typeof b.tag&&"function"==typeof b.state.onbeforeremove){var j=e.call(b.state.onbeforeremove,b);null!=j&&"function"==typeof j.then&&(h=1,f=j)}if(b.attrs&&"function"==typeof b.attrs.onbeforeremove){var j=e.call(b.attrs.onbeforeremove,b);null!=j&&"function"==typeof j.then&&(h|=2,g=j)}if(d(b,i),!h)G(b),F(a,b);else{if(null!=f){var k=function(){1&h&&(h&=2,!h&&c())};f.then(k,k)}if(null!=g){var k=function(){2&h&&(h&=1,!h&&c())};g.then(k,k)}}}function E(a,b){for(var c=0;c<b.instance.length;c++)a.removeChild(b.instance[c])}function F(a,b){for(;null!=b.dom&&b.dom.parentNode===a;){if("string"!=typeof b.tag){if(b=b.instance,null!=b)continue;}else if("<"===b.tag)E(a,b);else{if("["!==b.tag&&(a.removeChild(b.dom),!Array.isArray(b.children)))break;if(1!==b.children.length)for(var c,d=0;d<b.children.length;d++)c=b.children[d],null!=c&&F(a,c);else if(b=b.children[0],null!=b)continue}break}}function G(a){if("string"!=typeof a.tag&&"function"==typeof a.state.onremove&&e.call(a.state.onremove,a),a.attrs&&"function"==typeof a.attrs.onremove&&e.call(a.attrs.onremove,a),"string"!=typeof a.tag)null!=a.instance&&G(a.instance);else{var b=a.children;if(Array.isArray(b))for(var c,d=0;d<b.length;d++)c=b[d],null!=c&&G(c)}}function H(a,b,c){for(var d in b)I(a,d,null,b[d],c)}function I(a,b,c,d,e){if("key"!==b&&"is"!==b&&null!=d&&!N(b)&&(c!==d||M(a,b)||"object"==typeof d)){if("o"===b[0]&&"n"===b[1])return T(a,b,d);if("xlink:"===b.slice(0,6))a.dom.setAttributeNS("http://www.w3.org/1999/xlink",b.slice(6),d);else if("style"===b)R(a.dom,c,d);else if(O(a,b,e)){if("value"===b){if(("input"===a.tag||"textarea"===a.tag)&&a.dom.value===""+d&&a.dom===f())return;if("select"===a.tag&&null!==c&&a.dom.value===""+d)return;if("option"===a.tag&&null!==c&&a.dom.value===""+d)return}"input"===a.tag&&"type"===b?a.dom.setAttribute(b,d):a.dom[b]=d}else"boolean"==typeof d?d?a.dom.setAttribute(b,""):a.dom.removeAttribute(b):a.dom.setAttribute("className"===b?"class":b,d)}}function J(a,b,c,d){if(!("key"===b||"is"===b||null==c||N(b)))if("o"===b[0]&&"n"===b[1]&&!N(b))T(a,b,void 0);else if("style"===b)R(a.dom,c,null);else if(O(a,b,d)&&"className"!==b&&("value"!==b||"option"!==a.tag&&("select"!==a.tag||-1!==a.dom.selectedIndex||a.dom!==f()))&&("input"!==a.tag||"type"!==b))a.dom[b]=null;else{var e=b.indexOf(":");-1!==e&&(b=b.slice(e+1)),!1!==c&&a.dom.removeAttribute("className"===b?"class":b)}}function K(a,b){if("value"in b)if(null===b.value)-1!==a.dom.selectedIndex&&(a.dom.value=null);else{var c=""+b.value;(a.dom.value!==c||-1===a.dom.selectedIndex)&&(a.dom.value=c)}"selectedIndex"in b&&I(a,"selectedIndex",null,b.selectedIndex,void 0)}function L(a,b,c,d){if(null!=c)for(var e in c)I(a,e,b&&b[e],c[e],d);var f;if(null!=b)for(var e in b)null!=(f=b[e])&&(null==c||null==c[e])&&J(a,e,f,d)}function M(a,b){return"value"===b||"checked"===b||"selectedIndex"===b||"selected"===b&&a.dom===f()||"option"===a.tag&&a.dom.parentNode===Y.activeElement}function N(a){return"oninit"===a||"oncreate"===a||"onupdate"===a||"onremove"===a||"onbeforeremove"===a||"onbeforeupdate"===a}function O(a,b,c){return void 0===c&&(-1<a.tag.indexOf("-")||null!=a.attrs&&a.attrs.is||"href"!==b&&"list"!==b&&"form"!==b&&"width"!==b&&"height"!==b)&&b in a.dom}function P(a){return"-"+a.toLowerCase()}function Q(a){return"-"===a[0]&&"-"===a[1]?a:"cssFloat"===a?"float":a.replace(aa,P)}function R(a,b,c){if(b===c);else if(null==c)a.style.cssText="";else if("object"!=typeof c)a.style.cssText=c;else if(null==b||"object"!=typeof b)for(var d in a.style.cssText="",c){var e=c[d];null!=e&&a.style.setProperty(Q(d),e+"")}else{for(var d in c){var e=c[d];null!=e&&(e+="")!==b[d]+""&&a.style.setProperty(Q(d),e)}for(var d in b)null!=b[d]&&null==c[d]&&a.style.removeProperty(Q(d))}}function S(){this._=X}function T(a,b,c){if(null!=a.events){if(a.events[b]===c)return;null!=c&&("function"==typeof c||"object"==typeof c)?(null==a.events[b]&&a.dom.addEventListener(b.slice(2),a.events,!1),a.events[b]=c):(null!=a.events[b]&&a.dom.removeEventListener(b.slice(2),a.events,!1),a.events[b]=void 0)}else null!=c&&("function"==typeof c||"object"==typeof c)&&(a.events=new S,a.dom.addEventListener(b.slice(2),a.events,!1),a.events[b]=c)}function U(a,b,c){"function"==typeof a.oninit&&e.call(a.oninit,b),"function"==typeof a.oncreate&&c.push(e.bind(a.oncreate,b))}function V(a,b,c){"function"==typeof a.onupdate&&c.push(e.bind(a.onupdate,b))}function W(a,b){do{if(null!=a.attrs&&"function"==typeof a.attrs.onbeforeupdate){var c=e.call(a.attrs.onbeforeupdate,a,b);if(void 0!==c&&!c)break}if("string"!=typeof a.tag&&"function"==typeof a.state.onbeforeupdate){var c=e.call(a.state.onbeforeupdate,a,b);if(void 0!==c&&!c)break}return!1}while(!1);return a.dom=b.dom,a.domSize=b.domSize,a.instance=b.instance,a.attrs=b.attrs,a.children=b.children,a.text=b.text,!0}var X,Y=b&&b.document,Z={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},$={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"},_=[],aa=/[A-Z]/g;return S.prototype=Object.create(null),S.prototype.handleEvent=function(a){var b,c=this["on"+a.type];"function"==typeof c?b=c.call(a.currentTarget,a):"function"==typeof c.handleEvent&&c.handleEvent(a),this._&&!1!==a.redraw&&(0,this._)(),!1===b&&(a.preventDefault(),a.stopPropagation())},function(b,c,d){if(!b)throw new TypeError("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var e=[],g=f(),h=b.namespaceURI;null==b.vnodes&&(b.textContent=""),c=a.normalizeChildren(Array.isArray(c)?c:[c]);var j=X;try{X="function"==typeof d?d:void 0,o(b,b.vnodes,c,e,null,"http://www.w3.org/1999/xhtml"===h?void 0:h)}finally{X=j}b.vnodes=c,null!=g&&f()!==g&&"function"==typeof g.focus&&g.focus();for(var k=0;k<e.length;k++)e[k]()}}(window),k=function(b,c,d){function e(){if(h)throw new Error("Nested m.redraw.sync() call");h=!0;for(var c=0;c<g.length;c+=2)try{b(g[c],a(g[c+1]),f)}catch(a){d.error(a)}h=!1}function f(){i||(i=!0,c(function(){i=!1,e()}))}var g=[],h=!1,i=!1;return f.sync=e,{mount:function(c,d){if(null!=d&&null==d.view&&"function"!=typeof d)throw new TypeError("m.mount(element, component) expects a component, not a vnode");var e=g.indexOf(c);0<=e&&(g.splice(e,2),b(c,[],f)),null!=d&&(g.push(c,d),b(c,a(d),f))},redraw:f}}(j,requestAnimationFrame,console),l=function(a){function b(a,d){if(Array.isArray(d))for(var e=0;e<d.length;e++)b(a+"["+e+"]",d[e]);else if("[object Object]"===Object.prototype.toString.call(d))for(var e in d)b(a+"["+e+"]",d[e]);else c.push(encodeURIComponent(a)+(null!=d&&""!==d?"="+encodeURIComponent(d):""))}if("[object Object]"!==Object.prototype.toString.call(a))return"";var c=[];for(var d in a)b(d,a[d]);return c.join("&")},n=Object.assign||function(a,b){b&&Object.keys(b).forEach(function(c){a[c]=b[c]})},o=function(a,b){if(/:([^\/\.-]+)(\.{3})?:/.test(a))throw new SyntaxError("Template parameter names *must* be separated");if(null==b)return a;var c=a.indexOf("?"),d=a.indexOf("#"),e=0>d?a.length:d,f=0>c?e:c,g=a.slice(0,f),h={};n(h,b);var i=g.replace(/:([^\/\.-]+)(\.{3})?/g,function(a,c,d){return delete h[c],null==b[c]?a:d?b[c]:encodeURIComponent(b[c]+"")}),j=i.indexOf("?"),k=i.indexOf("#"),m=0>k?i.length:k,o=0>j?m:j,p=i.slice(0,o);0<=c&&(p+=a.slice(c,e)),0<=j&&(p+=(0>c?"?":"&")+i.slice(j,m));var q=l(h);return q&&(p+=(0>c&&0>j?"?":"&")+q),0<=d&&(p+=a.slice(d)),0<=k&&(p+=(0>d?"":"&")+i.slice(k)),p},p=function(a,b,c){function d(a){return new b(a)}function e(a){return function(e,f){function g(){0==--j&&"function"==typeof c&&c()}function h(a){var b=a.then;return a.constructor=d,a.then=function(){j++;var c=b.apply(a,arguments);return c.then(g,function(a){if(g(),0===j)throw a}),h(c)},a}"string"==typeof e?null==f&&(f={}):(f=e,e=e.url);var i=new b(function(b,c){a(o(e,f.params),f,function(a){if("function"==typeof f.type)if(Array.isArray(a))for(var c=0;c<a.length;c++)a[c]=new f.type(a[c]);else a=new f.type(a);b(a)},c)});if(!0===f.background)return i;var j=0;return h(i)}}function f(a,b){for(var c in a.headers)if({}.hasOwnProperty.call(a.headers,c)&&b.test(c))return!0;return!1}var g=0;return d.prototype=b.prototype,d.__proto__=b,{request:e(function(b,c,d,g){var h,i=null==c.method?"GET":c.method.toUpperCase(),j=c.body,k=(null==c.serialize||c.serialize===JSON.serialize)&&!(j instanceof a.FormData),l=c.responseType||("function"==typeof c.extract?"":"json"),m=new a.XMLHttpRequest,n=!1,o=m,p=m.abort;for(var q in m.abort=function(){n=!0,p.call(this)},m.open(i,b,!1!==c.async,"string"==typeof c.user?c.user:void 0,"string"==typeof c.password?c.password:void 0),k&&null!=j&&!f(c,/^content0-type1$/i)&&m.setRequestHeader("Content-Type","application/json; charset=utf-8"),"function"==typeof c.deserialize||f(c,/^accept$/i)||m.setRequestHeader("Accept","application/json, text/*"),c.withCredentials&&(m.withCredentials=c.withCredentials),c.timeout&&(m.timeout=c.timeout),m.responseType=l,c.headers)({}).hasOwnProperty.call(c.headers,q)&&m.setRequestHeader(q,c.headers[q]);m.onreadystatechange=function(a){if(!n&&4===a.target.readyState)try{var f,h=200<=a.target.status&&300>a.target.status||304===a.target.status||/^file:\/\//i.test(b),i=a.target.response;if("json"===l?!a.target.responseType&&"function"!=typeof c.extract&&(i=JSON.parse(a.target.responseText)):(!l||"text"===l)&&null==i&&(i=a.target.responseText),"function"==typeof c.extract?(i=c.extract(a.target,c),h=!0):"function"==typeof c.deserialize&&(i=c.deserialize(i)),h)d(i);else{try{f=a.target.responseText}catch(a){f=i}var j=new Error(f);j.code=a.target.status,j.response=i,g(j)}}catch(a){g(a)}},"function"==typeof c.config&&(m=c.config(m,c,b)||m,m!==o&&(h=m.abort,m.abort=function(){n=!0,h.call(this)})),null==j?m.send():"function"==typeof c.serialize?m.send(c.serialize(j)):j instanceof a.FormData?m.send(j):m.send(JSON.stringify(j))}),jsonp:e(function(b,c,d,e){var f=c.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+g++,h=a.document.createElement("script");a[f]=function(b){delete a[f],h.parentNode.removeChild(h),d(b)},h.onerror=function(){delete a[f],h.parentNode.removeChild(h),e(new Error("JSONP request failed"))},h.src=b+(0>b.indexOf("?")?"?":"&")+encodeURIComponent(c.callbackKey||"callback")+"="+encodeURIComponent(f),a.document.documentElement.appendChild(h)})}}(window,Promise,k.redraw),q=k,r=function(){return e.apply(this,arguments)};r.m=e,r.trust=e.trust,r.fragment=e.fragment,r.mount=q.mount;var m=function(a){if(""===a||null==a)return{};"?"===a.charAt(0)&&(a=a.slice(1));for(var b=a.split("&"),c={},d={},e=0;e<b.length;e++){var f=b[e].split("="),g=decodeURIComponent(f[0]),h=2===f.length?decodeURIComponent(f[1]):"";"true"===h?h=!0:"false"===h&&(h=!1);var j=g.split(/\]\[?|\[/),k=d;-1<g.indexOf("[")&&j.pop();for(var l=0;l<j.length;l++){var m=j[l],n=j[l+1],o=""==n||!isNaN(parseInt(n,10));if(""===m){var g=j.slice(0,l).join();null==c[g]&&(c[g]=Array.isArray(k)?k.length:0),m=c[g]++}else if("__proto__"===m)break;if(l==j.length-1)k[m]=h;else{var p=Object.getOwnPropertyDescriptor(k,m);null!=p&&(p=p.value),null==p&&(k[m]=p=o?[]:{}),k=p}}}return d},s=function(a){var b=a.indexOf("?"),c=a.indexOf("#"),d=0>c?a.length:c,e=0>b?d:b,f=a.slice(0,e).replace(/\/{2,}/g,"/");return f?("/"!==f[0]&&(f="/"+f),1<f.length&&"/"===f[f.length-1]&&(f=f.slice(0,-1))):f="/",{path:f,params:0>b?{}:m(a.slice(b+1,d))}},t=function(a){var b=s(a),c=Object.keys(b.params),d=[],e=new RegExp("^"+b.path.replace(/:([^\/.-]+)(\.{3}|\.(?!\.)|-)?|[\\^$*+.()|\[\]{}]/g,function(a,b,c){return null==b?"\\"+a:(d.push({k:b,r:"..."===c}),"..."===c?"(.*)":"."===c?"([^/]+)\\.":"([^/]+)"+(c||""))})+"$");return function(a){for(var f=0;f<c.length;f++)if(b.params[c[f]]!==a.params[c[f]])return!1;if(!d.length)return e.test(a.path);var g=e.exec(a.path);if(null==g)return!1;for(var f=0;f<d.length;f++)a.params[d[f].k]=d[f].r?g[f+1]:decodeURIComponent(g[f+1]);return!0}},u={};r.route=function(b,c){function d(a,c,d){if(a=o(a,c),null!=g){g();var e=d?d.state:null,h=d?d.title:null;d&&d.replace?b.history.replaceState(e,h,f.prefix+a):b.history.pushState(e,h,f.prefix+a)}else b.location.href=f.prefix+a}function f(e,i,o){function q(){function a(){if(o===i)throw new Error("Could not resolve default route "+i);d(i,null,{replace:!0})}function e(b){for(;b<w.length;b++)if(w[b].check(q)){var d=w[b].component,f=w[b].route,g=d,n=l=function(a){return n===l?a===p?e(b+1):void(h=null!=a&&("function"==typeof a.view||"function"==typeof a)?a:"div",j=q.params,k=o,l=null,m=d.render?d:null,2===v?c.redraw():(v=2,c.redraw.sync())):void 0};return void(d.view||"function"==typeof d?(d={},n(g)):d.onmatch?y.then(function(){return d.onmatch(q.params,o,f)}).then(n,a):n("div"))}a()}z=!1;var g=b.location.hash;"#"!==f.prefix[0]&&(g=b.location.search+g,"?"!==f.prefix[0]&&(g=b.location.pathname+g,"/"!==g[0]&&(g="/"+g)));var o=g.concat().replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent).slice(f.prefix.length),q=s(o);n(q.params,b.history.state),e(0)}if(null==e)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var r,v=0,w=Object.keys(o).map(function(a){if("/"!==a[0])throw new SyntaxError("Routes must start with a `/`");if(/:([^\/\.-]+)(\.{3})?:/.test(a))throw new SyntaxError("Route parameter names must be separated with either `/`, `.`, or `-`");return{route:a,component:o[a],check:t(a)}}),x="function"==typeof setImmediate?setImmediate:setTimeout,y=Promise.resolve(),z=!1;if(g=null,null!=i){var A=s(i);if(!w.some(function(a){return a.check(A)}))throw new ReferenceError("Default route doesn't match any known routes")}return g=function(){z||(z=!0,x(q))},"function"==typeof b.history.pushState?(r=function(){b.removeEventListener("popstate",g,!1)},b.addEventListener("popstate",g,!1)):"#"===f.prefix[0]&&(g=null,r=function(){b.removeEventListener("hashchange",q,!1)},b.addEventListener("hashchange",q,!1)),c.mount(e,{onbeforeupdate:function(){return v=v?2:1,v&&u!==m},oncreate:q,onremove:r,view:function(){if(v&&u!==m){var b=[a(h,j.key,j)];return m&&(b=m.render(b[0])),b}}})}var g,h,j,k,l,m=u,p=f.SKIP={};return f.set=function(a,b,c){null!=l&&(c=c||{},c.replace=!0),l=null,d(a,b,c)},f.get=function(){return k},f.prefix="#!",f.Link={view:function(a){var b,c,d=a.attrs.options,g={};n(g,a.attrs),g.selector=g.options=g.key=g.oninit=g.oncreate=g.onbeforeupdate=g.onupdate=g.onbeforeremove=g.onremove=null;var h=e(a.attrs.selector||"a",g,a.children);return(h.attrs.disabled=!!h.attrs.disabled)?(h.attrs.href=null,h.attrs["aria-disabled"]="true",h.attrs.onclick=null):(b=h.attrs.onclick,c=h.attrs.href,h.attrs.href=f.prefix+c,h.attrs.onclick=function(a){var e;"function"==typeof b?e=b.call(a.currentTarget,a):null==b||"object"!=typeof b||"function"==typeof b.handleEvent&&b.handleEvent(a),!1===e||a.defaultPrevented||0!==a.button&&0!==a.which&&1!==a.which||a.currentTarget.target&&"_self"!==a.currentTarget.target||a.ctrlKey||a.metaKey||a.shiftKey||a.altKey||(a.preventDefault(),a.redraw=!1,f.set(c,null,d))}),h}},f.param=function(a){return j&&null!=a?j[a]:j},f}(window,q),r.render=j,r.redraw=q.redraw,r.request=p.request,r.jsonp=p.jsonp,r.parseQueryString=m,r.buildQueryString=l,r.parsePathname=s,r.buildPathname=o,r.vnode=a,"undefined"==typeof module?window.m=r:module.exports=r})();
